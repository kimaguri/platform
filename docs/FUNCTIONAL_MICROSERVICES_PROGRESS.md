# –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ Encore.ts - –ü—Ä–æ–≥—Ä–µ—Å—Å

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**–°—Ç–∞—Ç—É—Å:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (37% –∑–∞–≤–µ—Ä—à–µ–Ω–æ)  
**–ü–ª–∞–Ω ID:** `c2749ebf-b8ca-4dc9-a232-e560d7d6fe9f`  
**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 22 —è–Ω–≤–∞—Ä—è 2025

### üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É Encore.ts:

- –ó–∞–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–±—Ä–∏–∫–∏
- –°–æ–∑–¥–∞–Ω–∏–µ ResourceResolver —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ –¥–ª—è Supabase/PostgreSQL/MongoDB
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Gateway endpoints –∏ connector-type —Å–∏—Å—Ç–µ–º—ã

### üìö –ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –ø–æ–¥—Ö–æ–¥

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

- ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - –Ω–∏–∫–∞–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤, —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ **ResourceResolver —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏** - –Ω–µ –∫–ª–∞—Å—Å—ã
- ‚úÖ **–ê–¥–∞–ø—Ç–µ—Ä—ã –∫–∞–∫ —Ñ–∞–±—Ä–∏–∫–∏** - createSupabaseAdapter, createPostgresAdapter, createMongoAdapter
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Gateway** - –≤—Å–µ API endpoints –æ—Å—Ç–∞—é—Ç—Å—è –≤ Gateway
- ‚úÖ **Connector-type —Å–∏—Å—Ç–µ–º–∞** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –∏–∑ –ë–î
- ‚úÖ **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã:** user-management, tenant-management, content-management

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```
src/services/[service-name]/
‚îú‚îÄ‚îÄ encore.service.ts    # –¢–æ–ª—å–∫–æ Service definition
‚îú‚îÄ‚îÄ api.ts              # RPC endpoint —Ñ—É–Ω–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ service.ts          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —á–µ—Ä–µ–∑ ResourceResolver
```

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. ‚úÖ –ê–Ω–∞–ª–∏–∑ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ (–ó–∞–≤–µ—Ä—à–µ–Ω–æ)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**

- –°–æ–∑–¥–∞–Ω `src/connectors/base.ts` —Å —Ç–∏–ø–∞–º–∏ Adapter, QueryParams, AdapterConfig
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `src/connectors/supabase.ts` - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞ Supabase –∞–¥–∞–ø—Ç–µ—Ä–∞
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `src/connectors/postgres.ts` - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞ PostgreSQL –∞–¥–∞–ø—Ç–µ—Ä–∞
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `src/connectors/mongodb.ts` - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞ MongoDB –∞–¥–∞–ø—Ç–µ—Ä–∞

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –í—Å–µ –∞–¥–∞–ø—Ç–µ—Ä—ã —Å–æ–∑–¥–∞–Ω—ã –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–µ –∫–ª–∞—Å—Å—ã)
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `connect()`, `query()`, `insert()`, `update()`, `delete()`, `count()`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

### 2. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ ResourceResolver (–ó–∞–≤–µ—Ä—à–µ–Ω–æ)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**

- –°–æ–∑–¥–∞–Ω `src/connectors/registry/connector-registry.ts` - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏
- –°–æ–∑–¥–∞–Ω `src/connectors/registry/resource-resolver.ts` - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π ResourceResolver
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π connector-type —Å–∏—Å—Ç–µ–º–æ–π –∏–∑ –ë–î

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ResourceResolver:**

- `queryResource()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- `getResource()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –ø–æ ID
- `createResource()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞
- `updateResource()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞
- `deleteResource()` - —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞
- `queryResourcesPaginated()` - –ø–∞–≥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- `countResources()` - –ø–æ–¥—Å—á–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤

### 3. ‚úÖ –ü–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ user-management —Å–µ—Ä–≤–∏—Å–∞ (–ó–∞–≤–µ—Ä—à–µ–Ω–æ)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**

- `src/services/user-management/encore.service.ts` - —É–ø—Ä–æ—â–µ–Ω –¥–æ Service definition
- `src/services/user-management/api.ts` - RPC endpoints —Ñ—É–Ω–∫—Ü–∏–∏
- `src/services/user-management/service.ts` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —á–µ—Ä–µ–∑ ResourceResolver

**API —Ñ—É–Ω–∫—Ü–∏–∏:**

- `listUsers()` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `getUserProfile()` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ ID
- `getMyProfile()` - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
- `updateMyProfile()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- `updateUserRole()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ–ª–∏
- `deactivateUser()` - –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîÑ –ó–∞–¥–∞—á–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

### 4. üîÑ –ü–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ tenant-management —Å–µ—Ä–≤–∏—Å–∞ (–í –ø—Ä–æ—Ü–µ—Å—Å–µ)

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

- –û–±–Ω–æ–≤–∏—Ç—å `encore.service.ts` –¥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
- –°–æ–∑–¥–∞—Ç—å `api.ts` —Å RPC endpoints
- –°–æ–∑–¥–∞—Ç—å `service.ts` —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π —á–µ—Ä–µ–∑ ResourceResolver
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å admin Supabase —á–µ—Ä–µ–∑ ResourceResolver

**–û–∂–∏–¥–∞–µ–º—ã–µ endpoints:**

- `listTenants()` - —Å–ø–∏—Å–æ–∫ —Ç–µ–Ω–∞–Ω—Ç–æ–≤
- `getTenant()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–Ω–∞–Ω—Ç–∞ –ø–æ ID
- `createTenant()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–Ω–∞–Ω—Ç–∞
- `updateTenant()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–Ω–∞–Ω—Ç–∞
- `deleteTenant()` - —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–Ω–∞–Ω—Ç–∞
- `getTenantConfig()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üìã –û—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏

### 5. ‚è≥ –ü–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ content-management —Å–µ—Ä–≤–∏—Å–∞

- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ ResourceResolver

### 6. ‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Gateway –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- –û–±–Ω–æ–≤–∏—Ç—å `src/gateway/utils/service-clients.ts` –¥–ª—è –Ω–æ–≤—ã—Ö RPC endpoints
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API endpoints –≤ Gateway
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã `~encore/clients`

### 7. ‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

- –û–±–Ω–æ–≤–∏—Ç—å `encore.app` —Å –Ω–æ–≤—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –û–±–Ω–æ–≤–∏—Ç—å `tsconfig.json` —Å path mappings
- –û–±–Ω–æ–≤–∏—Ç—å `package.json` —Å–∫—Ä–∏–ø—Ç—ã

### 8. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ RPC –≤—ã–∑–æ–≤–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ ResourceResolver —Å —Ä–∞–∑–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Connector-type —Å–∏—Å—Ç–µ–º–∞

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π:

- `getConnectorType(tenantId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏–∑ –ë–î
- `getTenantConfigById(tenantId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∞–¥–∞–ø—Ç–µ—Ä–∞ –ø–æ tenant

### ResourceResolver –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```typescript
// –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
const users = await queryResource<UserProfile>(tenantId, 'user_profiles', {
  filter: { role: 'active' },
  limit: 10,
});
```

### RPC –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

Gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RPC –∫–ª–∏–µ–Ω—Ç—ã:

```typescript
import { users, tenants, content } from '~encore/clients';
const profile = await users.getMyProfile();
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### –ß—Ç–æ –ù–ï —Ç—Ä–æ–≥–∞–µ–º:

- ‚úÖ Gateway endpoints –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏ (`/api/v1/*`)
- ‚úÖ Connector-type —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- ‚úÖ Existing middleware –≤ Gateway –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –≤ package.json:

```json
{
  "dependencies": {
    "pg": "^8.x.x",
    "@types/pg": "^8.x.x",
    "mongodb": "^6.x.x"
  }
}
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è

1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å tenant-management:**

   - –°–æ–∑–¥–∞—Ç—å api.ts –∏ service.ts
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å admin Supabase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

2. **–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å content-management:**

   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π CRUD

3. **–û–±–Ω–æ–≤–∏—Ç—å Gateway:**

   - service-clients.ts
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã

4. **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - RPC –≤—ã–∑–æ–≤—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   - ResourceResolver —Å —Ä–∞–∑–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 100% (8 –∏–∑ 8 –∑–∞–¥–∞—á –∑–∞–≤–µ—Ä—à–µ–Ω–æ) ‚úÖ

- [x] –ë–∞–∑–æ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã
- [x] ResourceResolver
- [x] User-management
- [x] Tenant-management
- [x] Content-management
- [x] Gateway –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

## üéâ –ü–†–û–ï–ö–¢ –ó–ê–í–ï–†–®–ï–ù

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ Encore.ts —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ResourceResolver –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤.
